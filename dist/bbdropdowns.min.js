!function(e){"use strict";function t(){var e=!1,t=this,i=function(e){var t=e.firstElementChild.textContent.split(",")[1].trim(),n=document.querySelector("#"+e.getAttribute("aria-activedescendant"));"true"!==e.getAttribute("aria-expanded")&&n?e.getAttribute("aria-activedescendant")&&(e.firstChild.textContent=n.textContent):e.firstChild.textContent=t,n||e.removeAttribute("aria-activedescendant")},r=function(e){var t=e.target,n=t.nextElementSibling,r="true"===t.getAttribute("aria-expanded");e.preventDefault(),"click"!==e.type&&"keydown"!==e.type&&(r=!1),t&&n&&(t.setAttribute("aria-expanded",r?"false":"true"),n.setAttribute("aria-hidden",r?"true":"false"),e&&e.keyCode&&!r&&(e.target.getAttribute("aria-activedescendant")?document.getElementById(e.target.getAttribute("aria-activedescendant")).focus():n.querySelector("li:first-child a").focus())),"true"===t.getAttribute("data-select")&&i(t)},a=function(e,t){var n=t?[t]:document.querySelectorAll('.bb-dropdowns > li > a[aria-haspopup="true"]:not([data-clickonly])');Array.prototype.forEach.call(n,function(t){t.getAttribute("data-select")&&(t.getAttribute("data-clickonly")||"mouseleave"===e.type)||(t.nextElementSibling.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false")),"true"===t.getAttribute("data-select")&&i(t)})},o=function(e){var t=e.target.parentElement.parentElement;setTimeout(function(){"false"!==t.getAttribute("aria-hidden")||t.contains(document.activeElement)||a(e,t.previousElementSibling)},100)},l=function(e){var t,n="true"===e.target.getAttribute("data-select");32===e.keyCode||13===e.keyCode||40===e.keyCode?(e.preventDefault(),n&&32!==e.keyCode||r(e)):37!==e.keyCode&&39!==e.keyCode||n||(e.preventDefault(),(t=37===e.keyCode?e.target.parentElement.previousElementSibling:e.target.parentElement.nextElementSibling)&&(a(e,e.target),t.firstElementChild.focus()))},d=function(e){var t=document.createEvent("Event");t.initEvent("change",!0,!0),e.dispatchEvent(t)},u=function(e,t,n){var i,r,a=e?e.target:n,o=t,l=!1;Array.prototype.forEach.call(t.parentElement.querySelectorAll("li > a"),function(e){"true"===e.getAttribute("aria-checked")&&(r=e.textContent),e.removeAttribute("aria-checked")}),i="selected-"+Date.now(),a.blur(),a.id=i,a.setAttribute("aria-checked","true"),o.setAttribute("data-value",a.getAttribute("data-value")?a.getAttribute("data-value"):""),o.setAttribute("aria-activedescendant",i),r&&r===a.firstChild.textContent||(o.firstChild.textContent=a.firstChild.textContent,l=!0),n||o.click(),!n&&l&&d(o),e&&"click"!==e.type&&o.focus()},c=function(e,t){var n,i,r=t||document.querySelector('.bb-dropdowns > li > a[aria-expanded="true"]');27===e.keyCode?(e.preventDefault(),r.click(),r.focus()):9===e.keyCode?e.preventDefault():38===e.keyCode?(e.preventDefault(),(n=e.target.parentElement.previousElementSibling)&&n.firstElementChild.focus()):40===e.keyCode?(e.preventDefault(),(i=e.target.parentElement.nextElementSibling)&&i.firstElementChild.focus()):(13===e.keyCode||32===e.keyCode||"click"===e.type&&"A"===e.target.tagName)&&("true"===r.getAttribute("data-select")?(e.preventDefault(),u(e,r)):r.click())},s=function(e){var t,n,i,r=document.querySelector('.bb-dropdowns > li > a[aria-expanded="true"]');return"menuitemradio"===e.target.getAttribute("role")?(c(e,r),!1):(27!==e.keyCode&&32!==e.keyCode||!r?38===e.keyCode?(e.preventDefault(),(t=e.target.parentElement.previousElementSibling||e.target.parentElement.parentElement.lastElementChild)&&t.firstElementChild.focus()):40===e.keyCode?(e.preventDefault(),(n=e.target.parentElement.nextElementSibling||e.target.parentElement.parentElement.firstElementChild)&&n.firstElementChild.focus()):37!==e.keyCode&&39!==e.keyCode||!r||(e.preventDefault(),(i=37===e.keyCode?r.parentElement.previousElementSibling:r.parentElement.nextElementSibling)&&(r.click(),i.firstElementChild.focus())):(e.preventDefault(),r.click(),r.focus()),!0)},f=function(e){var t=document.querySelectorAll('.bb-dropdowns > li > a[aria-expanded="true"]');Array.prototype.forEach.call(t,function(t){t===e.target||t.nextElementSibling.contains(e.target)||a(e,t)})},p=function(e){e.forEach(function(e){var t=e.offsetWidth;e.nextElementSibling.style.minWidth=t>160?t+"px":null})},m=new MutationObserver(function(e){e.forEach(function(e){(e.removedNodes.length||e.addedNodes.length)&&t.init(e.target.previousElementSibling)})});this.initialized=Boolean(n.length),this.init=function(t){var d,v=t?[t]:document.querySelectorAll(".bb-dropdowns > li > a"),b=!1,E={childList:!0};Array.prototype.forEach.call(v,function(e){var f,p=e.nextElementSibling;(-1===n.indexOf(e)||t)&&p&&(d="true"===e.getAttribute("data-select"),e.setAttribute("aria-haspopup","true"),e.setAttribute("role","button"),t||(e.addEventListener("click",r,!1),e.addEventListener("focus",a,!1),e.addEventListener("keydown",l,!1),p.addEventListener("keydown",s,!1),p.addEventListener("focusout",o,!1),p.addEventListener("click",c,!1),p.setAttribute("aria-label",e.textContent+(d?"":" submenu")),"true"===e.getAttribute("data-clickonly")||d?b=!0:(e.addEventListener("mouseover",r,!1),e.parentElement.addEventListener("mouseleave",a,!1))),d&&(f=e.offsetWidth,e.parentElement.parentElement.setAttribute("role","presentation"),e.style.minWidth=f+"px",p.setAttribute("role","menu"),t||(e.innerHTML=e.textContent+'<span class="sr-only">, '+e.textContent+"</span>",m.observe(p,E)),Array.prototype.forEach.call(p.querySelectorAll("li > a"),function(t){t.setAttribute("role","menuitemradio"),t.parentElement.setAttribute("role","presentation"),"true"===t.getAttribute("aria-checked")&&u(null,e,t),i(e)})),n.push(e))}),p(n),this.initialized||(b&&document.addEventListener("click",function(e){f(e)}),window.addEventListener("resize",function(){p(n)}),document.addEventListener("touchmove",function(){e=!0}),document.addEventListener("touchstart",function(){e=!1}),document.addEventListener("touchend",function(t){e||f(t)}),document.body.classList.remove("no-js"),this.initialized=!0)}}var n=[];"undefined"!=typeof module&&void 0!==module.exports?module.exports=t:"function"==typeof define&&define.amd?define("Dropdowns",[],function(){return t}):"object"==typeof e&&(e.BbDropdowns=t)}(this);